<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suivi Bachelor - The Dev Elite Club</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Lato:wght@300;400;700&family=Montserrat:wght@500;600;700&family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        /* === VARIABLES & GLOBAL === */
        :root {
            --cta: #D9A526;       /* Or */
            --brand-blue: #0F2C48; /* Bleu Nuit */
            --ivory: #F6F2E8;     
            --bronze: #B4792A;    
            --bg-page: #FDFBF7;
        }

        body { 
            margin: 0; 
            background-color: var(--bg-page); 
            color: var(--brand-blue); 
            font-family: 'Outfit', sans-serif; 
            display: flex; flex-direction: column; min-height: 100vh;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: var(--bronze); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--brand-blue); }

        /* === HEADER STYLES === */
        .top-bar {
            background-color: var(--brand-blue);
            padding: 15px 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            position: sticky; top: 0; z-index: 1000;
            border-bottom: 4px solid var(--cta);
        }
        .top-bar-container {
            max-width: 1400px; margin: 0 auto; padding: 0 20px;
            display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 20px;
        }
        .top-bar-left { display: flex; align-items: center; gap: 15px; flex: 1; min-width: 320px; }
        .logo-placeholder {
            width: 60px; height: 60px; border-radius: 50%; 
            border: 2px solid var(--cta); background: white; color: var(--brand-blue);
            display: flex; align-items: center; justify-content: center; font-size: 1.5rem;
        }
        .identity-stack { display: flex; flex-direction: column; justify-content: center; }
        .club-title-main { font-family: 'Playfair Display', serif; font-size: 1.2rem; font-weight: 700; color: #ffffff; line-height: 1.1; margin-bottom: 3px; }
        .club-subtitle { font-family: 'Lato', sans-serif; font-size: 0.75rem; color: var(--cta); font-weight: 600; }
        .top-bar-center { display: flex; gap: 12px; align-items: center; }
        
        .header-icon-btn {
            position: relative; width: 40px; height: 40px; border-radius: 50%;
            background: linear-gradient(135deg, #D9A526 0%, #B4792A 100%);
            border: 1px solid rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center;
            font-size: 1.1rem; text-decoration: none; transition: all 0.3s ease; color: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .header-icon-btn:hover { 
            transform: translateY(-3px) scale(1.1); 
            background: linear-gradient(135deg, #FFD700 0%, #D9A526 100%);
            box-shadow: 0 6px 15px rgba(217, 165, 38, 0.4); 
        }
        .header-icon-btn::after {
            content: attr(data-tooltip); position: absolute; top: 130%; left: 50%; transform: translateX(-50%) translateY(-10px);
            background-color: #fff; color: var(--brand-blue); padding: 4px 10px; border-radius: 20px;
            font-size: 0.7rem; font-weight: 700; white-space: nowrap; opacity: 0; visibility: hidden; transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); pointer-events: none; z-index: 100;
        }
        .header-icon-btn:hover::after { opacity: 1; visibility: visible; transform: translateX(-50%) translateY(0); }

        @keyframes cosmic-pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
        .btn-portfolio-cosmic {
            padding: 8px 20px; border-radius: 50px; font-family: 'Montserrat', sans-serif; font-weight: 600; font-size: 0.9rem;
            background: linear-gradient(135deg, #D9A526 0%, #B4792A 100%); color: white !important; text-decoration: none; 
            border: 1px solid rgba(255,255,255,0.2); display: inline-flex; align-items: center; gap: 8px; animation: cosmic-pulse 2s infinite;
        }
        .btn-portfolio-cosmic:hover { background: linear-gradient(135deg, #F1C40F 0%, #D9A526 100%); transform: translateY(-2px); }

        /* === DASHBOARD CONTENT STYLES === */
        .tab-btn { border-bottom: 3px solid transparent; transition: all 0.3s ease; color: #888; font-weight: 500; }
        .tab-active {
            border-bottom: 3px solid var(--cta); 
            color: var(--brand-blue);
            font-weight: 700;
            background-color: var(--ivory);
        }
        
        /* Accordion Styles */
        .module-accordion {
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .module-accordion:hover { border-color: var(--cta); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        
        .accordion-header {
            padding: 15px 20px;
            background-color: var(--ivory);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid transparent;
            transition: background-color 0.2s;
        }
        .accordion-header:hover { background-color: #fcfbf7; }
        .module-accordion.open .accordion-header { border-bottom: 1px solid #e2e8f0; }
        .module-accordion.open .accordion-icon { transform: rotate(180deg); }
        .accordion-icon { transition: transform 0.3s ease; color: var(--cta); }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out;
            background-color: white;
        }
        .module-accordion.open .accordion-content { max-height: 3000px; /* Arbitrary large height */ }

        /* Checkbox & Icons */
        .checkbox-wrapper input[type="checkbox"] {
            accent-color: var(--bronze); width: 1.1em; height: 1.1em; cursor: pointer;
        }
        .checkbox-wrapper input:checked + div span.subject-text {
            text-decoration: line-through; color: #94a3b8;
        }
        
        /* --- RESSOURCES ICONS (NOUVELLE LOGIQUE COULEURS VIVANTES) --- */
        .resource-btn {
            background: none; border: none; cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.1rem;
            margin: 0 5px;
            
            /* √âtat "Non aliment√©" : Color√© mais transparent (30%) */
            opacity: 0.3; 
            filter: grayscale(0%); /* On garde la couleur ! */
        }
        
        .resource-btn:hover {
            opacity: 0.6; 
            transform: scale(1.15);
        }

        /* √âtat "Aliment√©" / "Planifi√©" : Pleine couleur (100%) */
        .resource-btn.active {
            opacity: 1;
            transform: scale(1.1);
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.15));
        }
        .resource-btn.active:hover {
            transform: scale(1.2) translateY(-2px);
        }

        /* --- COULEURS SP√âCIFIQUES --- */
        .icon-video { color: #ef4444; }   /* Rouge Vid√©o */
        .icon-info { color: #06b6d4; }    /* Cyan Info */
        .icon-pres { color: #f97316; }    /* Orange Pr√©sentation */
        .icon-pdf { color: #dc2626; }     /* Rouge PDF */
        
        /* L'horloge : Bronze par d√©faut, Verte quand planifi√©e */
        .icon-clock { color: #B4792A; }
        .icon-clock.active { color: #10b981; } 

        /* === FOOTER STYLES === */
        .main-footer {
            background-color: var(--brand-blue); color: var(--ivory);
            padding-top: 50px; font-family: 'Lato', sans-serif; font-size: 0.95rem;
            width: 100%; margin-top: auto;
        }
        .footer-container { max-width: 1100px; margin: 0 auto; padding: 0 25px; }
        .footer-content { display: flex; flex-wrap: wrap; justify-content: space-between; gap: 30px; padding-bottom: 30px; align-items: flex-start; }
        .footer-identity { display: flex; flex-direction: row; align-items: center; gap: 20px; min-width: 300px; }
        .footer-logo-placeholder {
            width: 60px; height: 60px; border-radius: 8px; 
            border: 2px solid var(--cta); background: #fff; color: var(--brand-blue);
            display: flex; align-items: center; justify-content: center; font-size: 1.5rem;
        }
        .footer-info-compact { display: flex; flex-direction: column; text-align: left; }
        .footer-name { color: var(--cta); font-family: 'Playfair Display', serif; font-size: 1.1rem; font-weight: 700; line-height: 1.2; margin-bottom: 5px; margin-top:0; }
        .footer-contact-stack { display: flex; flex-direction: column; gap: 5px; font-size: 0.85rem; opacity: 0.8; }
        .footer-link { text-decoration: none; color: inherit; transition: color 0.3s; display: inline-block; }
        .footer-link:hover { color: var(--cta); }
        .footer-dock-col { display: flex; flex-direction: column; align-items: flex-end; gap: 10px; margin-left: auto; }
        .dock-group { display: flex; flex-direction: column; align-items: flex-end; gap: 5px; }
        .dock-label { font-family: 'Montserrat', sans-serif; font-size: 0.8rem; text-transform: uppercase; color: var(--cta); opacity: 0.7; }
        .icon-dock { display: flex; gap: 15px; flex-wrap: wrap; justify-content: flex-end; align-items: center; }
        .icon-btn { 
            position: relative; width: 45px; height: 45px; border-radius: 50%; 
            background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(217, 165, 38, 0.3); 
            display: flex; align-items: center; justify-content: center; 
            font-size: 1.3rem; text-decoration: none; 
            transition: all 0.3s; cursor: pointer; color: #fff; 
        }
        .icon-btn:hover { transform: translateY(-5px) scale(1.1); background: #fff; border-color: #fff; }
        /* Footer Brands */
        .brand-whatsapp { color: #25D366 !important; } .icon-btn:hover .brand-whatsapp { color: #25D366 !important; }
        .brand-discord { color: #5865F2 !important; } .icon-btn:hover .brand-discord { color: #5865F2 !important; }
        .brand-linkedin { color: #0077b5 !important; } .icon-btn:hover .brand-linkedin { color: #0077b5 !important; }
        .brand-instagram { color: #E1306C !important; } .icon-btn:hover .brand-instagram { color: #E1306C !important; }
        .brand-tiktok { color: #00f2ea !important; text-shadow: 2px 2px 0px #ff0050; } .icon-btn:hover .brand-tiktok { color: #000 !important; text-shadow: none; } 
        .brand-nav { color: var(--cta) !important; } .icon-btn:hover .brand-nav { color: var(--brand-blue) !important; }

        .icon-btn::after {
            content: attr(data-tooltip); position: absolute; bottom: 120%; left: 50%; transform: translateX(-50%) translateY(10px);
            background-color: #fff; color: var(--brand-blue); padding: 5px 12px; border-radius: 20px;
            font-size: 0.75rem; font-weight: 700; white-space: nowrap; opacity: 0; visibility: hidden; transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); pointer-events: none; z-index: 100;
        }
        .icon-btn:hover::after { opacity: 1; visibility: visible; transform: translateX(-50%) translateY(0); }
        .dock-separator { width: 1px; height: 30px; background-color: rgba(255,255,255,0.2); margin: 0 10px; }
        .footer-bottom { 
            text-align: center; padding: 15px 0; font-size: 0.8rem; 
            color: rgba(255,255,255,0.4); background-color: rgba(0,0,0,0.2); 
            border-top: 1px solid rgba(255,255,255,0.05); width: 100%;
        }

        @media (max-width: 768px) {
            .footer-content { flex-direction: column; align-items: center; text-align: center; }
            .footer-identity { flex-direction: column; text-align: center; }
            .footer-dock-col { align-items: center; width: 100%; gap: 30px; margin-left: 0; }
            .icon-dock { justify-content: center; flex-wrap: wrap; }
            .dock-group { align-items: center; }
            .dock-separator { display: none; }
            .top-bar-container { justify-content: center; }
            .top-bar-left { justify-content: center; flex: 100%; text-align: center; }
        }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="top-bar-container">
            <div class="top-bar-left">
                <div class="logo-placeholder">
                    <i class="fas fa-code"></i>
                </div>
                <div class="identity-stack">
                    <span class="club-title-main">üí´ The Dev Elite Club By Studi ‚ú®</span>
                    <span class="club-subtitle">La Villa des Codeurs Bris√©s üíî dans la Jungle du PYTHON ! üå¥</span>
                </div>
            </div>
            
            <div class="top-bar-center">
                <a href="#" class="header-icon-btn" aria-label="Start/Accueil" data-tooltip="Accueil"><i class="fas fa-home"></i></a>
                <a href="#" class="header-icon-btn" aria-label="Mon Espace" data-tooltip="Mon Espace"><i class="fas fa-chart-pie"></i></a>
                <a href="#" class="header-icon-btn" aria-label="Lexique Latin" data-tooltip="Lexique"><i class="fas fa-scroll"></i></a>
                <a href="#" class="header-icon-btn" aria-label="Atelier" data-tooltip="Atelier"><i class="fas fa-tools"></i></a>
                <a href="#" class="header-icon-btn" aria-label="Planning Live" data-tooltip="Planning"><i class="fas fa-calendar-alt"></i></a>
                <a href="#" class="header-icon-btn" aria-label="√Ä propos de moi" data-tooltip="Profil"><i class="fas fa-user"></i></a>
            </div>

            <a href="#" class="btn-portfolio-cosmic">
                <span>üìÑ</span> Mon portfolio
            </a>
        </div>
    </div>

    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full z-0">

        <div class="mb-8 bg-white p-4 rounded-lg shadow-sm border border-gray-100 flex items-center justify-between flex-wrap gap-4">
            <div class="flex items-center gap-4">
                 <div class="bg-gray-100 p-3 rounded-full text-brand-blue"><i class="fas fa-graduation-cap text-xl"></i></div>
                 <div>
                    <h2 class="font-bold text-lg" style="color: var(--brand-blue)">Progression Globale</h2>
                    <p class="text-sm text-gray-500">Bachelor Python</p>
                 </div>
            </div>
            <div class="w-full md:w-1/3 flex items-center gap-3">
                <div class="w-full bg-gray-200 rounded-full h-3">
                    <div id="global-progress-bar" class="h-full rounded-full bg-yellow-500 transition-all duration-500" style="width: 0%; background-color: var(--bronze);"></div>
                </div>
                <span class="font-bold text-lg" style="color: var(--brand-blue)" id="global-progress-text">0%</span>
            </div>
        </div>

        <div class="flex space-x-2 md:space-x-4 overflow-x-auto pb-1 mb-6" id="tabs-container">
            <button onclick="switchTab(1)" id="tab-btn-1" class="tab-btn tab-active rounded-t-lg px-6 py-3 whitespace-nowrap flex items-center gap-2">
                <span class="font-bold bg-blue-900 text-white px-2 py-0.5 rounded text-xs" style="background-color: var(--brand-blue)">B1</span>
                <span>Conception</span>
            </button>
            <button onclick="switchTab(2)" id="tab-btn-2" class="tab-btn rounded-t-lg px-6 py-3 whitespace-nowrap flex items-center gap-2">
                <span class="font-bold bg-gray-200 text-gray-600 px-2 py-0.5 rounded text-xs">B2</span>
                <span>Gestion</span>
            </button>
            <button onclick="switchTab(3)" id="tab-btn-3" class="tab-btn rounded-t-lg px-6 py-3 whitespace-nowrap flex items-center gap-2">
                <span class="font-bold bg-gray-200 text-gray-600 px-2 py-0.5 rounded text-xs">B3</span>
                <span>D√©v. Python</span>
            </button>
        </div>

        <div id="content-1" class="tab-content block">
             <div class="border-l-4 p-5 mb-6 rounded-r-lg shadow-sm bg-white" style="border-color: var(--brand-blue);">
                <h2 class="text-xl font-bold" style="color: var(--brand-blue);">B1_Conception et sp√©cification d'une solution digitale</h2>
                <div class="mt-2 text-right font-bold text-2xl" style="color: var(--bronze)" id="progress-text-1">0%</div>
            </div>
            <div id="modules-container-1"></div>
        </div>

        <div id="content-2" class="tab-content hidden">
            <div class="border-l-4 p-5 mb-6 rounded-r-lg shadow-sm bg-white" style="border-color: var(--brand-blue);">
                <h2 class="text-xl font-bold" style="color: var(--brand-blue);">B2_Gestion, pilotage et testing d'une Solution Digitale</h2>
                 <div class="mt-2 text-right font-bold text-2xl" style="color: var(--bronze)" id="progress-text-2">0%</div>
            </div>
            <div id="modules-container-2"></div>
        </div>

        <div id="content-3" class="tab-content hidden">
             <div class="border-l-4 p-5 mb-6 rounded-r-lg shadow-sm bg-white" style="border-color: var(--brand-blue);">
                <h2 class="text-xl font-bold" style="color: var(--brand-blue);">B3_D√©veloppement d‚Äôune solution digitale avec Python</h2>
                 <div class="mt-2 text-right font-bold text-2xl" style="color: var(--bronze)" id="progress-text-3">0%</div>
            </div>
             <div id="modules-container-3"></div>
        </div>

    </main>

    <footer class="main-footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-identity">
                    <div class="footer-logo-placeholder">
                        <i class="fas fa-university"></i>
                    </div>
                    <div class="footer-info-compact">
                        <div class="footer-name">Mathilde Martine PAISLEY</div>
                        <div class="footer-contact-stack">
                            <a href="mailto:Mathilde.martine.paisley@gmail.com" class="footer-link">üìß Mathilde.martine.paisley@gmail.com</a>
                            <a href="tel:+33685900887" class="footer-link">üì≤ 06 85 90 08 87</a>
                        </div>
                    </div>
                </div>
                <div class="footer-dock-col">
                    <div class="dock-group">
                        <div class="dock-label">Navigation & R√©seaux</div>
                        <div class="icon-dock">
                            <a href="#" class="icon-btn" data-tooltip="Accueil"><span class="brand-nav">üè†</span></a>
                            <a href="#" class="icon-btn" data-tooltip="Mon Espace"><span class="brand-nav">üìä</span></a>
                            <a href="#" class="icon-btn" data-tooltip="Lexique"><span class="brand-nav">üìú</span></a>
                            <a href="#" class="icon-btn" data-tooltip="Planning"><span class="brand-nav">üìÖ</span></a>
                            <a href="#" class="icon-btn" data-tooltip="Profil"><span class="brand-nav">üë§</span></a>
                            
                            <div class="dock-separator"></div>

                            <a href="#" class="icon-btn" data-tooltip="WhatsApp"><i class="fab fa-whatsapp brand-whatsapp"></i></a>
                            <a href="#" class="icon-btn" data-tooltip="Discord"><i class="fab fa-discord brand-discord"></i></a>
                            <a href="#" class="icon-btn" data-tooltip="LinkedIn"><i class="fab fa-linkedin brand-linkedin"></i></a>
                            <a href="#" class="icon-btn" data-tooltip="Instagram"><i class="fab fa-instagram brand-instagram"></i></a>
                            <a href="#" class="icon-btn" data-tooltip="TikTok"><i class="fab fa-tiktok brand-tiktok"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="footer-container">
                <p>¬© 2025 Tous droits r√©serv√©s ‚Äì Cr√©ation : 2025 ‚Äì Derni√®re mise √† jour : D√©cembre 2025</p>
            </div>
        </div>
    </footer>

    <!-- Scripts pour la Database (si pr√©sente) -->
    <script src="database.js"></script>

    <div id="schedule-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg shadow-2xl max-w-md w-full border-t-4 transform transition-all scale-100" style="border-color: var(--cta);">
            <div class="p-6">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-lg font-bold" style="color: var(--brand-blue)">Planifier une r√©vision ‚è∞</h3>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600"><i class="fas fa-times"></i></button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Sujet :</p>
                <p id="modal-subject-name" class="font-medium mb-6 bg-gray-50 p-2 rounded border border-gray-200" style="color: var(--brand-blue)"></p>
                <p class="text-sm font-bold mb-3" style="color: var(--bronze)">Quand voulez-vous r√©viser ?</p>
                <div class="grid grid-cols-2 gap-3">
                    <button onclick="createGCalEvent(3)" class="bg-white border hover:bg-gray-50 py-2 px-3 rounded shadow-sm transition-colors text-sm font-medium" style="color: var(--brand-blue); border-color: var(--brand-blue)">Dans 3 jours</button>
                    <button onclick="createGCalEvent(7)" class="bg-white border hover:bg-gray-50 py-2 px-3 rounded shadow-sm transition-colors text-sm font-medium" style="color: var(--brand-blue); border-color: var(--brand-blue)">Dans 7 jours</button>
                    <button onclick="createGCalEvent(10)" class="bg-white border hover:bg-gray-50 py-2 px-3 rounded shadow-sm transition-colors text-sm font-medium" style="color: var(--brand-blue); border-color: var(--brand-blue)">Dans 10 jours</button>
                    <button onclick="createGCalEvent(60)" class="bg-white border hover:bg-gray-50 py-2 px-3 rounded shadow-sm transition-colors text-sm font-medium" style="color: var(--bronze); border-color: var(--bronze)">Dans 60 jours</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DATA B1, B2 & B3 (STRICT MODE ACTIVATED) ---
        const programData = {
            1: [
                {
                    title: "B1_M01_Analyser les besoins client et identifier les solutions adapt√©es",
                    topics: ["B1_M01_S001-La veille et l'innovation","B1_M01_S002-Les modes d'innovation","B1_M01_S003-Les entreprises et l'innovation","B1_M01_S004-La cr√©ativit√© moteur de l'innovation","B1_M01_S005-Panorama des techniques de cr√©ativit√©","B1_M01_S006-L'√©cosyst√®me d'un projet digital","B1_M01_S007-√âtude comparative, le benchmark des solutions existantes","B1_M01_S008-D√©finir la cible de la solution digitale","B1_M01_S009-Les principaux acteurs d‚Äôun projet digital : la ma√Ætrise d‚Äôoeuvre","B1_M01_S010-Les principaux acteurs d‚Äôun projet digital : la ma√Ætrise d‚Äôouvrage","B1_M01_S011-Identifier les parties prenantes","B1_M01_S012-Etablir la gouvernance du projet, d√©finir les r√¥les et les responsabilit√©s","B1_M01_S013-Comprendre les enjeux et les retomb√©es d‚Äôun projet","B1_M01_S014-Le cahier des charges : l'expression du besoin"]
                },
                {
                    title: "B1_M02_D√©finir les options techniques de la solution digitale",
                    topics: ["B1_M02_S001-Les sp√©cificit√©s du projet digital","B1_M02_S002-Le recueil de l'analyse des besoins","B1_M02_S003-D√©finir la solution et le projet cibles","B1_M02_S004-D√©finir les objectifs et faire valider l‚Äôopportunit√© du projet","B1_M02_S005-Le choix technologique de la solution","B1_M02_S006-Le cahier des charges technique : d√©tailler la mise en ≈ìuvre","B1_M02_S007-Le cahier des charges technique : du besoin √† la solution technique","B1_M02_S008-Le cahier des charges technique : description fonctionnelle et technique","B1_M02_S009-La pr√©sentation et la validation de sa solution","B1_M02_S010-L'utilisation en interne du CDC"]
                },
                {
                    title: "B1_M03_D√©couvrir Adobe XD",
                    topics: ["B1_M03_S001-Pr√©sentation g√©n√©rale","B1_M03_S002-Gestion des documents","B1_M03_S003-Les outils de dessin vectoriel","B1_M03_S004-Les textes","B1_M03_S005-Importation de fichiers et d'images","B1_M03_S006-Les diff√©rents effets graphiques","B1_M03_S007-Cr√©ation d'√©l√©ments r√©p√©t√©s","B1_M03_S008-Redimensionnement r√©actif","B1_M03_S009-Utilisation des composants","B1_M03_S010-Utilisation et gestion des Actifs","B1_M03_S011-Le mode Prototype","B1_M03_S012-Plug-ins","B1_M03_S013-Partage de designs et de prototypes","B1_M03_S014-Les diff√©rents types d'export"]
                },
                {
                    title: "B1_M04_Utiliser l'√©diteur de graphiques Figma",
                    topics: ["B1_M04_S001-Pr√©sentation de l'application","B1_M04_S002-L'application Figma","B1_M04_S003-Importation et exportation de fichiers, utilisation de mod√®les","B1_M04_S004-Conception avanc√©e : menu d√©roulant, incrustation d'√©cran, personnaliser le design","B1_M04_S005-Cr√©er un prototype, partager et exporter"]
                },
                {
                    title: "B1_M05_D√©finir la m√©thodologie, la roadmap, les ressources et les livrables",
                    topics: ["B1_M05_S001-Introduction √† l'organisation d'un projet digital","B1_M05_S002-M√©thodologie pour piloter un projet digital : une d√©marche it√©rative","B1_M05_S003-Le r√¥le du chef de projet digital","B1_M05_S004-Les modes de gestion de projet dits \"classiques\"","B1_M05_S005-Les m√©thodologies agiles","B1_M05_S006-Les processus et les disciplines de la gestion de projet selon le PMBOK","B1_M05_S007-Les acteurs et les ressources du projet","B1_M05_S008-La premi√®re d√©coupe du projet","B1_M05_S009-La construction du planning","B1_M05_S010-La gestion du budget du projet","B1_M05_S011-La gestion des risques","B1_M05_S012-La communication autour du projet"]
                },
                {
                    title: "B1_M06_Concevoir une solution digitale",
                    topics: ["B1_M06_S001-La r√©alisation d'une √©tude d'opportunit√©","B1_M06_S002-Le r√¥le de la note de cadrage","B1_M06_S003-L'√©tude de faisabilit√©","B1_M06_S004-L'analyse des risques","B1_M06_S005-L'analyse fonctionnelle","B1_M06_S006-Proposer une solution optimale en termes de co√ªt","B1_M06_S007-Proposer une solution optimale en termes de d√©lais de production","B1_M06_S008-Proposer une solution optimale en termes de performance attendue","B1_M06_S009-Proposer une solution optimale en termes de p√©rennit√©","B1_M06_S010-L'utilit√© du suivi de la performance","B1_M06_S011-Les indicateurs de suivi selon les objectifs","B1_M06_S012-La construction d'un tableau de bord op√©rationnel"]
                },
                {
                    title: "B1_M07_D√©couvrir les m√©thodologies de gestion de projets agiles",
                    topics: ["B1_M07_S001-Les m√©thodologies agiles","B1_M07_S002-Introduction √† la m√©thode Scrum","B1_M07_S003-Comprendre Kanban","B1_M07_S004-Pr√©sentation du diagramme de Gantt"]
                },
                {
                    title: "B1_M08_Concevoir l‚Äôarchitecture logicielle de la solution",
                    topics: ["B1_M08_S001-L‚Äôarchitecture en appels et retours","B1_M08_S002-L‚Äôarchitecture en couches","B1_M08_S003-L‚Äôarchitecture centr√©e sur les donn√©es","B1_M08_S004-L‚Äôarchitecture en flot de donn√©es","B1_M08_S005-L‚Äôarchitecture orient√©e objets","B1_M08_S006-L‚Äôarchitecture orient√©e agents"]
                },
                {
                    title: "B1_M09_Comprendre la sp√©cification fonctionnelle",
                    topics: ["B1_M09_S001-Comprendre les objectifs de la sp√©cification fonctionnelle","B1_M09_S002-Comment r√©diger une sp√©cification fonctionnelle"]
                },
                {
                    title: "B1_M10_Elaborer un cahier des charges fonctionnel",
                    topics: ["B1_M10_S001-Le cahier des charges fonctionnel : le contexte du projet et ses enjeux","B1_M10_S002-Le cahier des charges fonctionnel : la port√©e de la solution","B1_M10_S003-Le cahier des charges fonctionnel : les contraintes","B1_M10_S004-Le cahier des charges fonctionnel : les parcours utilisateurs","B1_M10_S005-Le cahier des charges fonctionnel : les fonctionnalit√©s cl√©s et les sp√©cifications","B1_M10_S006-Le cahier des charges fonctionnel : l'approche cr√©ative","B1_M10_S007-Le cahier des charges fonctionnel : l'organisation du projet"]
                },
                {
                    title: "B1_M11_D√©finir les objectifs SMART de sa solution digitale",
                    topics: ["B1_M11_S001-Le recueil et l'analyse des besoins","B1_M11_S002-La validation de la solution","B1_M11_S003-Le droit du web","B1_M11_S004-D√©finition du droit num√©rique","B1_M11_S005-Les responsabilit√©s des intervenants","B1_M11_S006-Le droit p√©nal de l'informatique","B1_M11_S007-L'informatique sur le lieu de travail","B1_M11_S008-La l√©gislation compar√©e","B1_M11_S009-L'informatique et droit public","B1_M11_S010-Le cadre juridique du e-commerce","B1_M11_S011-Les textes de r√©f√©rence"]
                }
            ],
            2: [
                {
                    title: "B2_M01_Manager et piloter les t√¢ches avec ses √©quipes projet gr√¢ce √† TRELLO",
                    topics: ["B2_M01_S001-L'application Trello", "B2_M01_S002-Cr√©ation du compte", "B2_M01_S003-D√©couverte de l'interface", "B2_M01_S004-D√©couvrir le contenu d'un projet", "B2_M01_S005-Le travail collaboratif : les membres", "B2_M01_S006-Le travail collaboratif : les √©quipes", "B2_M01_S007-Les tableaux", "B2_M01_S008-Les listes", "B2_M01_S009-Les cartes", "B2_M01_S010-Les checklists", "B2_M01_S011-Les utilitaires", "B2_M01_S012-Les Power-ups"]
                },
                {
                    title: "B2_M02_Manager et piloter les t√¢ches avec ses √©quipes projet gr√¢ce √† JIRA",
                    topics: ["B2_M02_S001-D√©couvrir JIRA", "B2_M02_S002-Apprendre JIRA", "B2_M02_S003-Les m√©thodologies agiles avec JIRA", "B2_M02_S004-JIRA pour les √©quipes", "B2_M02_S005-JIRA pour les administrateurs", "B2_M02_S006-Utiliser JIRA avec Gitlab"]
                },
                {
                    title: "B2_M03_G√©rer son projet avec GanttProject",
                    topics: ["B2_M03_S001-Apprendre √† utiliser Gantt project", "B2_M03_S002-Cadrer le projet", "B2_M03_S003-Construire le plan de projet", "B2_M03_S004-Cr√©ation des d√©pendances", "B2_M03_S005-G√©rer les affichages", "B2_M03_S006-Le r√©seau du projet", "B2_M03_S007-G√©rer les ressources", "B2_M03_S008-Le suivi de projet", "B2_M03_S009-Les outils d'impression et d'exportation", "B2_M03_S010-Application - Gestion de projet - GanttProject"]
                },
                {
                    title: "B2_M04_Comprendre la mod√©lisation UML",
                    topics: ["B2_M04_S001-Introduction √† la mod√©lisation conceptuelle de donn√©es avec UML", "B2_M04_S002-Les diagrammes de classes", "B2_M04_S003-Les diagrammes d'objets", "B2_M04_S004-Les diagrammes de composants", "B2_M04_S005-Les diagrammes de d√©ploiement", "B2_M04_S006-Les diagrammes des paquets", "B2_M04_S007-Les diagrammes de structure composite", "B2_M04_S008-Les diagrammes de profils", "B2_M04_S009-Diagrammes de cas d'utilisation UML (UML use case diagram)", "B2_M04_S010-Les diagrammes √©tats-transitions", "B2_M04_S011-Les diagrammes d'activit√©", "B2_M04_S012-Les diagrammes de s√©quence", "B2_M04_S013-Les diagrammes de communication", "B2_M04_S014-Les diagrammes global d'interaction", "B2_M04_S015-Les diagrammes de temps"]
                },
                {
                    title: "B2_M05_Utiliser l'outil Agile : Scrum",
                    topics: ["B2_M05_S001-Comprendre les diff√©rents cycles de vie des projets en m√©thode Agile", "B2_M05_S002-D√©finir le cadre de la solution digitale", "B2_M05_S003-La pr√©paration du backlog", "B2_M05_S004-La notion de travail en sprint", "B2_M05_S005-Les retours et les feedbacks", "B2_M05_S006-La r√©it√©ration en fonction des feedbacks", "B2_M05_S007-Le r√¥le du Scrum Master", "B2_M05_S008-Le r√¥le du product owner"]
                },
                {
                    title: "B2_M06_Utiliser l'outil Agile : Kanban",
                    topics: ["B2_M06_S001-L'application Smartsheet", "B2_M06_S002-La plateforme Monday"]
                },
                {
                    title: "B2_M07_Tester son application Web",
                    topics: ["B2_M07_S001L‚Äôexamen des exigences", "B2_M07_S002-Les tests d‚Äôusabilit√©", "B2_M07_S003-Les tests unitaires", "B2_M07_S004-Les tests d‚Äôint√©gration", "B2_M07_S005-Les tests des composants", "B2_M07_S006-Les tests de bout en bout (End to End)", "B2_M07_S007-Les tests d‚Äôacceptation", "B2_M07_S008-Les tests de r√©gression", "B2_M07_S009-Int√©gration continue", "B2_M07_S010-Le d√©ploiement continu (CD)"]
                },
                {
                    title: "B2_M08_R√©aliser des tests fonctionnels",
                    topics: ["B2_M08_S001-Les notions de test unitaire et test fonctionnel", "B2_M08_S002-Les tests unitaires avec PHPUnit", "B2_M08_S003-Les tests fonctionnels avec WebTestCase et Panther", "B2_M08_S004-Les tests unitaires avec les mocks", "B2_M08_S005-Le Test Driven Development", "B2_M08_S006-Les services", "B2_M08_S007-L'Ajax avec Axios et Symfony", "B2_M08_S008-Tests d'int√©gration et recette fonctionnelle", "B2_M08_S009-Mesurer son application", "B2_M08_S010-A/B testing"]
                },
                {
                    title: "B2_M09_Proposer des solutions suite √† un audit",
                    topics: ["B2_M09_S001-La r√©solution d'une situation critique pour la survie du projet", "B2_M09_S002-Le suivi des indicateurs qualit√© et am√©lioration continue", "B2_M09_S003-La conception de la solution gr√¢ce au Design Thinking", "B2_M09_S004-Design Thinking La phase d‚Äôempathie, la compr√©hension du besoin", "B2_M09_S005-Design Thinking D√©finir la probl√©matique", "B2_M09_S006-Design Thinking La phase d‚Äôid√©ation", "B2_M09_S007-Design Thinking La phase de prototypage de la solution", "B2_M09_S008-Design Thinking La phase de test de la solution"]
                }
            ],
            3: [
                {
                    title: "B3_M01_Piloter la production de contenus digitaux",
                    topics: ["B3_M01_S001-Comment et pourquoi se former √† la production de contenus digitaux ?","B3_M01_S002-Introduction √† la production de contenus digitaux","B3_M01_S003-La cr√©ation de contenu digital en ad√©quation avec sa cible","B3_M01_S004-L'orientation artistique et le brief cr√©atif","B3_M01_S005-La gestion de la production de contenus digitaux","B3_M01_S006-La mise en place op√©rationnelle de sa strat√©gie de production de contenus","B3_M01_S007-La proposition de production de contenu","B3_M01_S008-Application - Piloter la production de contenus digitaux"]
                },
                {
                    title: "B3_M02_Cr√©er un site web avec HTML, CSS et le Framework Bootstrap",
                    topics: ["B3_M02_S001-Introduction HTML et CSS","B3_M02_S002-Syntaxe g√©n√©rale de HTML","B3_M02_S003-L'organisation du texte","B3_M02_S004-Un langage hypertexte","B3_M02_S005-Le multim√©dia en HTML","B3_M02_S006-Introduction au CSS","B3_M02_S007-CSS3 : Le stylage du texte","B3_M02_S008-La structuration logique en HTML5 et le mod√®le de bo√Ætes en CSS3","B3_M02_S009-Les s√©lecteurs CSS","B3_M02_S010-La mise en page avec CSS","B3_M02_S011-La cr√©ation de tableaux","B3_M02_S012-La cr√©ation de formulaires","B3_M02_S013-Layout avec CSS Grid","B3_M02_S014-Les effets avanc√©s de CSS","B3_M02_S015-Utiliser des documentations CSS","B3_M02_S016-Le responsive design","B3_M02_S017-Valider la qualit√© de son site","B3_M02_S018-L'installation et la prise en main du framework Bootstrap - Hello world","B3_M02_S019-La grille bootstrap","B3_M02_S020-Les √©l√©ments bootstrap","B3_M02_S021-Les composants bootstrap","B3_M02_S022-Ouverture vers d'autres framework CSS","B3_M02_S023-SASS","B3_M02_S024-Le r√©f√©rencement des sites Web","B3_M02_S025-D√©ployer son site sur le Web"]
                },
                {
                    title: "B3_M03_Dynamiser vos sites web avec JavaScript",
                    topics: ["B3_M03_S001-La programmation √©v√©nementielle en JavaScript","B3_M03_S002-Le formulaire HTML et JavaScript","B3_M03_S003-Initiation aux objets et aux classes","B3_M03_S004-L'API DOM","B3_M03_S005-Pr√©sentation de la librairie JQuery","B3_M03_S006-Les bases de JQuery","B3_M03_S007-La programmation AJAX","B3_M03_S008-Les promesses et l'API Fetch","B3_M03_S009-L'utilisation de JSON","B3_M03_S010-L'API Canvas en JavaScript"]
                },
                {
                    title: "B3_M04_D√©velopper des sites web dynamiques avec PHP",
                    topics: ["B3_M04_S001-PHP et HTML (sorties)","B3_M04_S002-Les types de donn√©es, les variables et les constantes","B3_M04_S003-Les op√©rateurs de comparaison et les expressions bool√©ennes","B3_M04_S004-Les fonctions","B3_M04_S005-Les tableaux","B3_M04_S006-Les conditions","B3_M04_S007-Les boucles","B3_M04_S008-Cr√©er ses propres fonctions","B3_M04_S009-L'organisation des fichiers PHP","B3_M04_S010-Les superglobales Get, Post et Files","B3_M04_S011-Les superglobales Server, Env et Session","B3_M04_S012-La s√©curit√©","B3_M04_S013-La manipulation des dates","B3_M04_S014-La manipulation des fichiers en PHP","B3_M04_S015-Les expressions r√©guli√®res","B3_M04_S016-Utiliser la documentation PHP et Standard de codage PHP","B3_M04_S017-La pr√©paration de l'environnement de travail","B3_M04_S018-La programmation Orient√©e Objet concepts de base","B3_M04_S019-La programmation Orient√©e Objet concepts avanc√©s","B3_M04_S020-La gestion des erreurs","B3_M04_S021-La programmation Orient√©e Objet Design Patterns","B3_M04_S022-La programmation Orient√©e Objet L‚Äôencapsulation et la visibilit√©","B3_M04_S023-Le mod√®le MVC"]
                },
                {
                    title: "B3_M05_Cr√©er et administrer une base de donn√©es relationnelle",
                    topics: ["B3_M05_S001-Introduction g√©n√©rale aux bases de donn√©es, notion de SGBDR","B3_M05_S002-Mod√®le conceptuel de donn√©es et mod√®le logique de donn√©es","B3_M05_S003-Les diagrammes fonctionnels","B3_M05_S004-Le diagramme de classe","B3_M05_S005-Introduction au passage UML- Relationnel","B3_M05_S006-Cr√©ation et alimentation de bases de donn√©es SQL","B3_M05_S007-L'interrogation de bases de donn√©es SQL","B3_M05_S008-D√©couvrir un autre SGBDR PostgreSQL","B3_M05_S009-Connexion √† la base de donn√©es en PHP","B3_M05_S010-PHP/PDO : acc√®s en lecture/√©criture","B3_M05_S011-Les requetes SQL","B3_M05_S012-Les fonctions SQL","B3_M05_S013-Les jointures SQL","B3_M05_S014-G√©rer les acc√®s des utilisateurs au niveau PHP et BD","B3_M05_S015-D√©couverte d'un ORM PHP","B3_M05_S016-Projet : Cr√©er et administrer une base de donn√©es","B3_M05_S017-Introduction NOSQL","B3_M05_S018-Introduction √† MongoDB"]
                },
                {
                    title: "B3_M06_Cr√©er et administrer une base de donn√©es non relationnelle",
                    topics: ["B3_M06_S001-Introduction NOSQL","B3_M06_S002-Introduction √† MongoDB"]
                },
                {
                    title: "B3_M07_D√©velopper une application web avec Python",
                    topics: ["B3_M07_S001-L'interpr√©teur de commande Python","B3_M07_S002-Environnements de travail","B3_M07_S003-Variables et types de donn√©es","B3_M07_S004-Port√©e des variables et notion de r√©f√©rence","B3_M07_S005-Conditions en Python","B3_M07_S006-Boucles en Python","B3_M07_S007-Les structures de donn√©es en Python","B3_M07_S008-Structure d'un programme - fonctions","B3_M07_S009-Am√©liorer la qualit√© du code","B3_M07_S010-Structure d'un programme - modules","B3_M07_S011-Am√©liorer la qualit√© du code - les tests unitaires","B3_M07_S012-Notions th√©oriques de classe","B3_M07_S013-Constructeur et mot-cl√© self","B3_M07_S014-Les m√©thodes sp√©ciales","B3_M07_S015-L'h√©ritage","B3_M07_S016-La notion de d√©corateur en Python","B3_M07_S017-Cha√Æne de caract√®res en Python","B3_M07_S018-La gestion du temps en Python","B3_M07_S019-Math√©matiques en Python","B3_M07_S020-Plus loin en math√©matiques","B3_M07_S021-Visualiser des donn√©es sous formes de graphiques","B3_M07_S022-Gestion des fichiers en Python","B3_M07_S023-Requ√™tes HTTP","B3_M07_S024-Les bases de donn√©es relationnelles et Python","B3_M07_S025-Notion d'ORM (object-relational mapping)","B3_M07_S026-Cadre th√©orique de Flask","B3_M07_S027-Le moteur de template Jinja","B3_M07_S028-D√©ploiement en ligne du site Flask","B3_M07_S029-Cadre th√©orique de Django","B3_M07_S030-Les mod√®les en Django","B3_M07_S031-Les vues en Django","B3_M07_S032-API REST en Python","B3_M07_S033-La data visualisation avec Python","B3_M07_S034-La pr√©sentation des donn√©es et des librairies","B3_M07_S035-La librairie numpy","B3_M07_S036-La librairie pandas premi√®re approche","B3_M07_S037-Aller plus loin avec la librairie pandas","B3_M07_S038-La librairie matplotlib","B3_M07_S039-La librairie Seaborn","B3_M07_S040-La librairie Bokeh","B3_M07_S041-La data visualisation avanc√©e avec Streamlit","B3_M07_S042-Des pr√©sentations de r√©sultats impactantes"]
                },
                {
                    title: "B3_M08_D√©velopper une application mobile avec React Native",
                    topics: ["B3_M08_S001-Le d√©veloppement Mobile","B3_M08_S002-Introduction √† React Native : l'outil Expo","B3_M08_S003-Les bases de React Native","B3_M08_S004-Les composants React Native","B3_M08_S005-Les props et les states","B3_M08_S006-Style et mise en page avec Flexbox","B3_M08_S007-Du code diff√©rent en fonction de la plateforme","B3_M08_S008-L'utilisation de Redux","B3_M08_S009-Les extensions de Redux","B3_M08_S010-L'organisation d'une application React Native","B3_M08_S011-La navigation avec React Native","B3_M08_S012-Les diff√©rents types de navigators","B3_M08_S013-L'animation avec React Native","B3_M08_S014-Installer les √©mulateurs","B3_M08_S015-Utiliser une base donn√©es locale : SQLITE","B3_M08_S016-Les APIs React Native et modules natifs","B3_M08_S017-Le debugging","B3_M08_S018-Le d√©ploiement d'une application sur les stores","B3_M08_S019-Cr√©er une application React Native sans Expo","B3_M08_S020-Projet - d√©velopper une application mobile avec React Native"]
                },
                {
                    title: "B3_M09_Concevoir une API",
                    topics: ["B3_M09_S001-Pr√©sentation des API","B3_M09_S002-Concevoir une API","B3_M09_S003-G√©rer les acc√®s √† une API"]
                },
                {
                    title: "B3_M10_Utiliser des API",
                    topics: ["B3_M10_S001-Les API d'authentification (OAuth, ..)","B3_M10_S002-Les API Google / AWS","B3_M10_S003-Les API de paiement"]
                },
                {
                    title: "B3_M11_Utiliser un outil de gestion de version de code source",
                    topics: ["B3_M11_S001-Introduction √† la ligne de commande","B3_M11_S002-Introduction √† Git et Github","B3_M11_S003-Les bases","B3_M11_S004-Les interactions avec le d√©p√¥t distant","B3_M11_S005-Naviguer dans l'historique","B3_M11_S006-La gestion des branches","B3_M11_S007-Les branches avec Git - Rebaser","B3_M11_S008-Les bonnes pratiques","B3_M11_S009-Projet - Utiliser Git et Github pour g√©rer son code source","B3_M11_S010-Introduction √† Gitlab"]
                },
                {
                    title: "B3_M12_Maintenir et documenter son projet",
                    topics: ["B3_M12_S001-La documentation de l'architecture et du code","B3_M12_S002-Am√©liorer sa solution","B3_M12_S003-La documentation pour l'utilisateur","B3_M12_S004-Le pentest","B3_M12_S005-Gestion de la dette technique"]
                }
            ]
        };

        // --- STATE MANAGEMENT ---
        let userProgress = JSON.parse(localStorage.getItem('bachelor_progress_elite')) || {};
        let userSchedules = JSON.parse(localStorage.getItem('bachelor_schedules_elite')) || {}; 
        let dbRessources = window.dbRessources || {}; // From database.js if present

        function saveProgress() {
            localStorage.setItem('bachelor_progress_elite', JSON.stringify(userProgress));
            localStorage.setItem('bachelor_schedules_elite', JSON.stringify(userSchedules));
            updateUIStats();
        }

        // --- ACCORDION LOGIC ---
        function toggleAccordion(moduleId) {
            const el = document.getElementById(moduleId);
            el.classList.toggle('open');
        }

        // --- RESOURCE LOGIC (LINKING TO LECTEUR.HTML) ---
        // Cette fonction ouvre le lecteur avec l'ID correct pour lire dans la database
        function openResource(id, type) {
            
            // Pour l'instant, on simule l'ouverture ou on ouvre le lecteur
            const topicElement = document.getElementById(id).nextElementSibling.querySelector('span').innerText;
            // topicElement = "B1_M01_S001-Titre..."
            
            // Nettoyage pour l'URL (B1_M01_S001_Titre_Sans_Espace)
            const cleanId = topicElement.replace(/ /g, '_').replace(/-/g, '_').replace(/'/g, '');
            
            const url = `lecteur.html?id=${cleanId}`;
            window.open(url, '_blank');
        }

        // --- SCHEDULING ---
        let currentActiveTopicTitle = "";
        let currentActiveTopicId = "";

        function openScheduler(topicTitle, topicId) {
            currentActiveTopicTitle = topicTitle;
            currentActiveTopicId = topicId;
            document.getElementById('modal-subject-name').textContent = topicTitle;
            document.getElementById('schedule-modal').classList.remove('hidden');
            document.getElementById('schedule-modal').classList.add('flex');
        }
        function closeModal() {
            document.getElementById('schedule-modal').classList.add('hidden');
            document.getElementById('schedule-modal').classList.remove('flex');
        }
        function createGCalEvent(days) {
            if(!currentActiveTopicTitle) return;
            
            // 1. Google Calendar Logic
            const date = new Date(); date.setDate(date.getDate() + days);
            const dStr = date.toISOString().replace(/-|:|\.\d\d\d/g,"").split("T")[0];
            const url = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent("R√©vision: "+currentActiveTopicTitle)}&details=${encodeURIComponent("Via Dev Elite Dashboard")}&dates=${dStr}/${dStr}`;
            window.open(url, '_blank'); 
            
            // 2. Save "Scheduled" State (Aliment√©)
            if(currentActiveTopicId) {
                userSchedules[currentActiveTopicId] = true;
                saveProgress();
                // Update visual immediately
                const btn = document.getElementById(`clock-${currentActiveTopicId}`);
                if(btn) btn.classList.add('active');
            }

            closeModal();
        }

        function toggleTopic(id) {
            if (userProgress[id]) delete userProgress[id]; else userProgress[id] = true;
            saveProgress();
            const checkbox = document.getElementById(id);
            if(checkbox) checkbox.checked = userProgress[id];
            updateUIStats();
        }

        // --- RENDER ---
        function renderModules(blockId) {
            const container = document.getElementById(`modules-container-${blockId}`);
            const data = programData[blockId];
            if (!data || data.length === 0) return;

            container.innerHTML = ''; 

            data.forEach((module, mIndex) => {
                const modId = `acc-b${blockId}-m${mIndex}`;
                const accDiv = document.createElement('div');
                accDiv.className = 'module-accordion';
                accDiv.id = modId;

                let totalS = module.topics.length;
                let doneS = 0;
                module.topics.forEach((_, i) => { if(userProgress[`b${blockId}-m${mIndex}-s${i}`]) doneS++; });
                let modPct = Math.round((doneS/totalS)*100);

                accDiv.innerHTML = `
                    <div class="accordion-header" onclick="toggleAccordion('${modId}')">
                        <div class="flex items-center gap-3">
                             <div class="w-1.5 h-6 bg-yellow-500 rounded-full" style="background-color: var(--cta)"></div>
                             <div>
                                <h3 class="font-bold text-gray-800 text-sm md:text-base">${module.title}</h3>
                                <div class="text-xs text-gray-400 mt-0.5">${doneS}/${totalS} valid√©s</div>
                             </div>
                        </div>
                        <div class="flex items-center gap-4">
                            <span class="text-xs font-bold" style="color: var(--brand-blue)">${modPct}%</span>
                            <i class="fas fa-chevron-down accordion-icon"></i>
                        </div>
                    </div>
                    <div class="accordion-content">
                        <div class="p-2 space-y-1 bg-white"></div>
                    </div>
                `;

                const listContainer = accDiv.querySelector('.accordion-content > div');
                
                module.topics.forEach((topic, tIndex) => {
                    // ID Unique pour le checkbox et le localstorage
                    const uniqueId = `b${blockId}-m${mIndex}-s${tIndex}`;
                    const isChecked = userProgress[uniqueId] ? 'checked' : '';
                    
                    // Construction de la cl√© Database (ex: B1_M01_S001_La_veille...)
                    // On prend le titre complet et on remplace les espaces par _ pour matcher database.js
                    const dbKey = topic.replace(/ /g, '_').replace(/-/g, '_').replace(/'/g, '');
                    
                    // V√©rification pr√©sence ressources dans window.dbRessources
                    const res = window.dbRessources && window.dbRessources[dbKey] ? window.dbRessources[dbKey] : {};
                    
                    const hasVideo = res.video ? 'active' : '';
                    const hasInfo = res.info ? 'active' : '';
                    const hasPres = res.pres ? 'active' : ''; // Mapping "Presentation" to "Mindmap" key or create new
                    const hasPdf = res.pdf ? 'active' : '';
                    
                    // Clock active state from local storage
                    const hasClock = userSchedules[uniqueId] ? 'active' : '';

                    const row = document.createElement('div');
                    row.className = "flex items-center justify-between py-3 px-3 border-b border-gray-100 last:border-0 hover:bg-gray-50 transition-colors";
                    row.innerHTML = `
                        <div class="checkbox-wrapper flex items-start gap-3 flex-1">
                            <input type="checkbox" id="${uniqueId}" ${isChecked} onchange="toggleTopic('${uniqueId}')" class="mt-1">
                            <div class="cursor-pointer flex-1" onclick="document.getElementById('${uniqueId}').click()">
                                <span class="subject-text text-sm text-gray-700 block select-none font-medium">${topic}</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-2 ml-2">
                            <button onclick="openResource('${uniqueId}', 'video')" class="resource-btn icon-video ${hasVideo}" title="Vid√©o">
                                <i class="fas fa-video"></i>
                            </button>
                            <button onclick="openResource('${uniqueId}', 'info')" class="resource-btn icon-info ${hasInfo}" title="Infographie">
                                <i class="fas fa-chart-pie"></i>
                            </button>
                            <button onclick="openResource('${uniqueId}', 'pres')" class="resource-btn icon-pres ${hasPres}" title="Pr√©sentation">
                                <i class="fas fa-project-diagram"></i>
                            </button>
                            <button onclick="openResource('${uniqueId}', 'pdf')" class="resource-btn icon-pdf ${hasPdf}" title="Document PDF">
                                <i class="fas fa-file-pdf"></i>
                            </button>
                            <div class="w-px h-4 bg-gray-200 mx-1"></div>
                            <button id="clock-${uniqueId}" onclick="openScheduler('${topic.replace(/'/g, "\\'")}', '${uniqueId}')" class="resource-btn icon-clock ${hasClock}" title="Planifier">
                                <i class="far fa-clock"></i>
                            </button>
                        </div>
                    `;
                    listContainer.appendChild(row);
                });

                container.appendChild(accDiv);
            });
        }

        function updateUIStats() {
            let total = 0, done = 0;
            [1, 2, 3].forEach(bId => {
                let bT = 0, bD = 0;
                if(programData[bId]) {
                    programData[bId].forEach((m, mI) => {
                        m.topics.forEach((t, tI) => {
                            bT++; total++;
                            if(userProgress[`b${bId}-m${mI}-s${tI}`]) { bD++; done++; }
                        });
                    });
                }
                const pct = bT===0?0:Math.round((bD/bT)*100);
                const el = document.getElementById(`progress-text-${bId}`);
                if(el) el.textContent = `${pct}%`;
            });
            const gPct = total===0?0:Math.round((done/total)*100);
            document.getElementById('global-progress-text').textContent = `${gPct}%`;
            document.getElementById('global-progress-bar').style.width = `${gPct}%`;
        }

        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(e => { e.classList.add('hidden'); e.classList.remove('block'); });
            document.getElementById(`content-${id}`).classList.remove('hidden');
            document.getElementById(`content-${id}`).classList.add('block');
            document.querySelectorAll('#tabs-container button').forEach(b => { 
                b.classList.remove('tab-active'); 
                b.style.backgroundColor = ''; b.style.color = '';
            });
            const btn = document.getElementById(`tab-btn-${id}`);
            btn.classList.add('tab-active');
            renderModules(id);
        }

        window.onload = function() {
            // Check if database.js loaded
            if(typeof window.dbRessources === 'undefined') {
                console.warn("database.js n'est pas charg√©. Les ressources seront gris√©es.");
            }
            renderModules(1);
            renderModules(2);
            renderModules(3);
            updateUIStats();
        };
        window.onclick = function(e) { if(e.target == document.getElementById('schedule-modal')) closeModal(); }
    </script>
</body>
</html>